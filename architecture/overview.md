# Architecture Overview (v1.0)

The ZSI Copilot framework is a production-ready, domain-agnostic AI orchestration platform built on FastAPI, with dynamic agent discovery, modular Pydantic schemas, and a flexible, pluggable memory layer. Built under a “nail it before you scale it” philosophy, it supports rapid MVP hosting on lightweight platforms (Railway/Render) and provides clear extension paths to enterprise-grade infrastructure (AWS Lambda/API Gateway, Docker/Kubernetes, GCP, Azure, etc.).

This document also includes future-expansion hooks for OAuth2/JWT integration, observability enhancements, and environment-driven configuration, ensuring every deployment—no matter the domain—remains secure, observable, and extensible from day one.

## Key Features

- **Dynamic Agent Loading**  
  Agents are auto-discovered from `modules/<agent_name>/agent.py` via decorator registration or module inspection, enabling drop-in extensibility across any business domain—health, finance, productivity, trading, childcare, and more.

- **Pluggable Memory Backends**  
  Memory adapters conform to a common interface and can be swapped via environment configuration:
  - JSON file (local development)
  - Firestore / Supabase
  - DynamoDB
  - SQL or NoSQL stores
  - In-memory cache for stateless testing

- **Unified Schema & Contracts**  
  Pydantic models define `Intent`, `AgentResult`, and `UserMemory` contracts, ensuring type-safe requests, responses, and memory interactions. Each schema version is versioned and documented in `/docs/schemas.md`.

- **Secure & Configurable**  
  - API key and OAuth2/JWT support via FastAPI dependency injection  
  - Centralized CORS policies per environment (dev, staging, prod)  
  - Environment-driven configuration (`.env`, Vault, Secrets Manager)

- **OpenAPI-First Documentation**  
  - Comprehensive `/docs` generated by FastAPI and MkDocs-TechDocs  
  - Clear tags for core routes (orchestration, agents, health, metrics)  
  - Auto-generated examples and code snippets

- **Extensible Hosting Tiers**  
  - **MVP**: FastAPI + JSON memory on Railway/Render  
  - **Scale**: Serverless functions (AWS Lambda/API Gateway) + managed databases  
  - **Enterprise**: Containerized microservices (Docker, K8s) + dedicated observability  
    - **Hybrid Cloud**: seamless orchestration across on-prem and cloud deployments

- **Observability & Logging**  
  - Pluggable logging backends (stdout, CloudWatch, Stackdriver)  
  - Distributed tracing hooks (OpenTelemetry-ready)  
  - Health checks and metrics endpoints  
  - **Future Expansion Hooks**
    - OAuth2/JWT boilerplate with scopes, token introspection
    - Environment-driven feature flags (LaunchDarkly, ConfigCat)
    - Plug-in metrics dashboards (Grafana, Datadog)
    - CI/CD pipeline configs (GitHub Actions, GitLab CI, CircleCI)

This architecture ensures you can bootstrap a new AI-driven Copilot—whether “DietPilot”, “CareMatch”, “KyndleWay”, or “Zanalytics.app”—without losing any domain-specific logic. Simply add new agents, update schemas, and configure your memory and hosting settings.

## Future-Proof Checklist

1. Verify agent modules adhere to BaseAgent contract and registration decorator.
2. Review `.env.example` for all required environment variables.
3. Ensure memory adapter is selected via `ZSI_MEMORY_BACKEND` env var.
4. Confirm OpenAPI tags and metadata are accurate for each new endpoint.
5. Validate CORS and security dependencies in FastAPI config.
6. Integrate observability and tracing hooks before production rollout.
7. Update `mkdocs.yml` nav and theme settings for new sections.
8. Review hosting tier configs in `hosting.yaml` or equivalent.
9. Confirm environment variable management strategy (Vault, AWS Parameter Store, Kubernetes Secrets).
10. Audit and enforce security policies (CSP, rate limiting, WAF) prior to launch.
